---
layout: post
title: "Van Gogh's Starry Night as a phase portrait"
author: "Joseph Wilson"
categories: art
blurb: >
  My Dynamical Systems course had a competition to make the most creative phase portrait...
---

The Dynamical Systems course I took had a competition to invent a dynamical system with the most creative phase portrait.

Here's my entry: the Starry Night system.

<style>
code {
	white-space: pre-wrap !important;
}
</style>
```python
# Scalar part
s := (-2*(y/2 - 1)^2 + θ((x - 4.63)^2 + (y - 167/50)^2 - 1/25)*θ(-(x - 91/20)^2 - (y - 82/25)^2 + 49/625) - 3*θ(x/50 - y + sin(15*x + 1)/10 + 22/25)/10 - 4*θ(2*x/25 - y + 117*sin(29*x/5 + 1.3)/1000 + 49/50)/5 + 4*θ(19*x/100 - y + 31*sin(17*x/5 + 84/25)/200 + .77)/5 + 5/2 + 27*exp(-(100*(x - .19)^2 + 100*(y - 43/20)^2)^2)/10 + 3*exp(-(100*(x - 1/2)^2/7 + 100*(y - 19/5)^2/7)^2) + 27*exp(-(500*(x - 31/50)^2/11 + 500*(y - 2.07)^2/11)^2)/10 + 2*exp(-(50*(x - 57/50)^2 + 50*(y - 191/50)^2)^2) + 4*exp(-(20*(x - 29/25)^2 + 20*(y - 82/25)^2)^2) + 3*exp(-(50*(x - 8/5)^2 + 50*(y - 67/25)^2)^2) + 3*exp(-(200*(x - 1.69)^2/7 + 200*(y - 19/5)^2/7)^2)/2 + 2*exp(-(25*(x - 1.73)^2/3 + 25*(y - 1.9)^2/3)^2) + 3*exp(-(250*(x - 2)^2/3 + 250*(y - 93/25)^2/3)^2) + exp(-(5*(x - 5/2)^2/3 + 5*(y - 13/5)^2/3)^2) + 2*exp(-(250*(x - 76/25)^2/11 + 250*(y - 3.63)^2/11)^2) + exp(-(20*(x - 69/20)^2/3 + 20*(y - 2.1)^2/3)^2) + 2*exp(-(250*(x - 3.51)^2/11 + 250*(y - 76/25)^2/11)^2) + 27*exp(-(5*(x - 91/20)^2/2 + 5*(y - 169/50)^2/2)^2)/10)*θ(y + 7*abs(-x + 17*y*sin(13*y/5 + 4.33)/250 + .91) - 2.7)*θ(y + 10*abs(x + (-17*y/250 + 21/125)*sin(5*y/2 + 1.7) - 29/25) - 47/20)*θ(y + 10*abs(x + (-17*y/250 + 21/125)*sin(31*y/5 - 12/5) - 37/40) - 73/20)*θ(y + 121*abs(x + (-17*y/250 + 21/125)*sin(157*y/25 + 24/5) - 1.49)/50 - 1.63)*θ(y + 64*abs(x + (-17*y/250 + 21/125)*sin(79*y/10 + 3) - 2)/25 - .97)

# Vector part, x-component
v_x := (((((y - 82/25)*θ(-(x - 91/20)^2 - (y - 82/25)^2 + 2/5) + ((y - 43/20)*θ(-(x - .19)^2 - (y - 43/20)^2 + .01) + ((y - 2.07)*θ(-(x - 31/50)^2 - (y - 2.07)^2 + 11/500) + ((y - 76/25)*θ(-(x - 3.51)^2 - (y - 76/25)^2 + 11/250) + ((y - 3.63)*θ(-(x - 76/25)^2 - (y - 3.63)^2 + 11/250) + ((y - 93/25)*θ(-(x - 2)^2 - (y - 93/25)^2 + 3/250) + ((y - 19/5)*θ(-(x - 1.69)^2 - (y - 19/5)^2 + 7/200) + ((y - 191/50)*θ(-(x - 57/50)^2 - (y - 191/50)^2 + 1/50) + ((y - 19/5)*θ(-(x - 1/2)^2 - (y - 19/5)^2 + .07) + ((y - 82/25)*θ(-(x - 29/25)^2 - (y - 82/25)^2 + 1/20) + ((y - 67/25)*θ(-(x - 8/5)^2 - (y - 67/25)^2 + 1/50) + ((y - 1.9)*θ(-(x - 1.73)^2 - (y - 1.9)^2 + 3/25) + (-θ(-(x - 1.73)^2 - (y - 1.9)^2 + 3/25) + 1)*((2*x/5 - y + 77/25)/((x - .3)^2/4 + (y - 16/5)^2/4)^3 + (-2*x/5 + y - 41/25)/((x - 12/5)^2/4 + (y - 13/5)^2/4)^3 + (2*x/5 - y + 37/50)/((x - 17/5)^2 + (y - 2.1)^2)^3))*(-θ(-(x - 8/5)^2 - (y - 67/25)^2 + 1/50) + 1))*(-θ(-(x - 29/25)^2 - (y - 82/25)^2 + 1/20) + 1))*(-θ(-(x - 1/2)^2 - (y - 19/5)^2 + .07) + 1))*(-θ(-(x - 57/50)^2 - (y - 191/50)^2 + 1/50) + 1))*(-θ(-(x - 1.69)^2 - (y - 19/5)^2 + 7/200) + 1))*(-θ(-(x - 2)^2 - (y - 93/25)^2 + 3/250) + 1))*(-θ(-(x - 76/25)^2 - (y - 3.63)^2 + 11/250) + 1))*(-θ(-(x - 3.51)^2 - (y - 76/25)^2 + 11/250) + 1))*(-θ(-(x - 31/50)^2 - (y - 2.07)^2 + 11/500) + 1))*(-θ(-(x - .19)^2 - (y - 43/20)^2 + .01) + 1))*(-θ(-(x - 91/20)^2 - (y - 82/25)^2 + 2/5) + 1))*(-θ(19*x/100 - y + 31*sin(17*x/5 + 84/25)/200 + .77) + 1) + θ(19*x/100 - y + 31*sin(17*x/5 + 84/25)/200 + .77))*(-θ(2*x/25 - y + 117*sin(29*x/5 + 1.3)/1000 + 49/50) + 1) + θ(2*x/25 - y + 117*sin(29*x/5 + 1.3)/1000 + 49/50))*(-θ(x/50 - y + sin(15*x + 1)/10 + 22/25) + 1) + θ(x/50 - y + sin(15*x + 1)/10 + 22/25))*θ(y + 7*abs(-x + 17*y*sin(13*y/5 + 4.33)/250 + .91) - 2.7)*θ(y + 10*abs(x + (-17*y/250 + 21/125)*sin(5*y/2 + 1.7) - 29/25) - 47/20)*θ(y + 10*abs(x + (-17*y/250 + 21/125)*sin(31*y/5 - 12/5) - 37/40) - 73/20)*θ(y + 121*abs(x + (-17*y/250 + 21/125)*sin(157*y/25 + 24/5) - 1.49)/50 - 1.63)*θ(y + 64*abs(x + (-17*y/250 + 21/125)*sin(79*y/10 + 3) - 2)/25 - .97) + (-θ(y + 7*abs(-x + 17*y*sin(13*y/5 + 4.33)/250 + .91) - 2.7)*θ(y + 10*abs(x + (-17*y/250 + 21/125)*sin(5*y/2 + 1.7) - 29/25) - 47/20)*θ(y + 10*abs(x + (-17*y/250 + 21/125)*sin(31*y/5 - 12/5) - 37/40) - 73/20)*θ(y + 121*abs(x + (-17*y/250 + 21/125)*sin(157*y/25 + 24/5) - 1.49)/50 - 1.63)*θ(y + 64*abs(x + (-17*y/250 + 21/125)*sin(79*y/10 + 3) - 2)/25 - .97) + 1)*sin(8*x)*sin(6*y)

# Vector part, y-component
v_y := (y + 1/5)*(-θ(y + 7*abs(-x + 17*y*sin(13*y/5 + 4.33)/250 + .91) - 2.7)*θ(y + 10*abs(x + (-17*y/250 + 21/125)*sin(5*y/2 + 1.7) - 29/25) - 47/20)*θ(y + 10*abs(x + (-17*y/250 + 21/125)*sin(31*y/5 - 12/5) - 37/40) - 73/20)*θ(y + 121*abs(x + (-17*y/250 + 21/125)*sin(157*y/25 + 24/5) - 1.49)/50 - 1.63)*θ(y + 64*abs(x + (-17*y/250 + 21/125)*sin(79*y/10 + 3) - 2)/25 - .97) + 1) + (((((-x + 91/20)*θ(-(x - 91/20)^2 - (y - 82/25)^2 + 2/5) + ((-x + .19)*θ(-(x - .19)^2 - (y - 43/20)^2 + .01) + ((-x + 31/50)*θ(-(x - 31/50)^2 - (y - 2.07)^2 + 11/500) + ((-x + 3.51)*θ(-(x - 3.51)^2 - (y - 76/25)^2 + 11/250) + ((-x + 76/25)*θ(-(x - 76/25)^2 - (y - 3.63)^2 + 11/250) + ((-x + 2)*θ(-(x - 2)^2 - (y - 93/25)^2 + 3/250) + ((-x + 1.69)*θ(-(x - 1.69)^2 - (y - 19/5)^2 + 7/200) + ((-x + 57/50)*θ(-(x - 57/50)^2 - (y - 191/50)^2 + 1/50) + ((-x + 1/2)*θ(-(x - 1/2)^2 - (y - 19/5)^2 + .07) + ((-x + 29/25)*θ(-(x - 29/25)^2 - (y - 82/25)^2 + 1/20) + ((-x + 8/5)*θ(-(x - 8/5)^2 - (y - 67/25)^2 + 1/50) + ((-x + 1.73)*θ(-(x - 1.73)^2 - (y - 1.9)^2 + 3/25) + (-θ(-(x - 1.73)^2 - (y - 1.9)^2 + 3/25) + 1)*((7*x/10 + 7*y/25 - 553/500)/((x - .3)^2/4 + (y - 16/5)^2/4)^3 + (-7*x/10 - 7*y/25 + 301/125)/((x - 12/5)^2/4 + (y - 13/5)^2/4)^3 + (7*x/10 + 7*y/25 - 371/125)/((x - 17/5)^2 + (y - 2.1)^2)^3))*(-θ(-(x - 8/5)^2 - (y - 67/25)^2 + 1/50) + 1))*(-θ(-(x - 29/25)^2 - (y - 82/25)^2 + 1/20) + 1))*(-θ(-(x - 1/2)^2 - (y - 19/5)^2 + .07) + 1))*(-θ(-(x - 57/50)^2 - (y - 191/50)^2 + 1/50) + 1))*(-θ(-(x - 1.69)^2 - (y - 19/5)^2 + 7/200) + 1))*(-θ(-(x - 2)^2 - (y - 93/25)^2 + 3/250) + 1))*(-θ(-(x - 76/25)^2 - (y - 3.63)^2 + 11/250) + 1))*(-θ(-(x - 3.51)^2 - (y - 76/25)^2 + 11/250) + 1))*(-θ(-(x - 31/50)^2 - (y - 2.07)^2 + 11/500) + 1))*(-θ(-(x - .19)^2 - (y - 43/20)^2 + .01) + 1))*(-θ(-(x - 91/20)^2 - (y - 82/25)^2 + 2/5) + 1))*(-θ(19*x/100 - y + 31*sin(17*x/5 + 84/25)/200 + .77) + 1) + (527*cos(17*x/5 + 84/25)/1000 + .19)*θ(19*x/100 - y + 31*sin(17*x/5 + 84/25)/200 + .77))*(-θ(2*x/25 - y + 117*sin(29*x/5 + 1.3)/1000 + 49/50) + 1) + (3393*cos(29*x/5 + 1.3)/5000 + 2/25)*θ(2*x/25 - y + 117*sin(29*x/5 + 1.3)/1000 + 49/50))*(-θ(x/50 - y + sin(15*x + 1)/10 + 22/25) + 1) + (3*cos(15*x + 1)/2 + 1/50)*θ(x/50 - y + sin(15*x + 1)/10 + 22/25))*θ(y + 7*abs(-x + 17*y*sin(13*y/5 + 4.33)/250 + .91) - 2.7)*θ(y + 10*abs(x + (-17*y/250 + 21/125)*sin(5*y/2 + 1.7) - 29/25) - 47/20)*θ(y + 10*abs(x + (-17*y/250 + 21/125)*sin(31*y/5 - 12/5) - 37/40) - 73/20)*θ(y + 121*abs(x + (-17*y/250 + 21/125)*sin(157*y/25 + 24/5) - 1.49)/50 - 1.63)*θ(y + 64*abs(x + (-17*y/250 + 21/125)*sin(79*y/10 + 3) - 2)/25 - .97)

# Normalisation of vector part
norm := sqrt(v_x^2 + v_y^2)

# Final system
dx/dt := s*v_x/norm
dy/dt := s*v_y/norm
```

<img src="{{ site.github.url }}/assets/img/starry-night-phase-portrait.svg"/>


The equations were not written by hand, of course, but generated by linearly combining simpler subsystems in an object oriented manner with Python.

The Starry Night system won the competition --- but I was also the only one to enter...
