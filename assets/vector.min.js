(()=>{"use strict";function t(t){return new Promise((function(e,i){var s=new XMLHttpRequest;s.open("GET",t),s.onload=function(){200==s.status?e(s.response):i(Error(s.statusText))},s.onerror=function(){i(Error("Network Error"))},s.send()}))}function e(t){return(new DOMParser).parseFromString(t,"image/svg+xml").documentElement}class i{next;data;constructor(t){this.data=t,this.next=null}toString(){return this.data.toString()}}class s{head;constructor(){this.head=null}insert(t){if(null==this.head)this.head=new i(t);else{let e=this.head;this.head=new i(t),this.head.next=e}}first(){return null!=this.head?this.head.data:null}remove(){return null!=this.head&&(this.head=this.head.next,!0)}toString(){let t=this.head,e="";for(;null!=t;)e+=t.toString()+" ",t=t.next;return e.substr(0,e.length-1)}[Symbol.iterator](){let t=this.head;return{next(){if(null==t)return{done:!0,value:void 0};{let e=t.data;return t=t.next,{done:!1,value:e}}}}}}class r{relationships;_size;constructor(){this.relationships=new Map,this._size=0}add(t){this.contains(t)||(this.relationships.set(t,new Set),this._size++)}contains(t){return this.relationships.has(t)}remove(t){this.relationships.delete(t)&&this._size--}size(){return this._size}addDependency(t,e){this.add(t),this.add(e),this.relationships.get(t).add(e),this.traverse(t,t)}traverse(t,e,i=new Set){i.add(t);let s=this.getDependents(t,!0);for(let t of s){if(t==e)throw new Error("circular dependency");i.has(t)||this.traverse(t,e,i)}}hasDependents(t){return this.contains(t)&&0!=this.relationships.get(t).size}getAdjacentNodes(t){return this.relationships.get(t)}getDependents(t,e=!1){if(!this.relationships.has(t))return[];if(e)return this.relationships.get(t).keys();{let e=this.getTopologicalDependents(t);return e.remove(),e}}getTopologicalSort(){let t=new s,e=new Set;for(let i of this.getNodes())e.has(i)||this.getTopologicalDependents(i,e,t);return t}getTopologicalDependents(t,e=new Set,i=new s){e.add(t);let r=this.getDependents(t,!0);for(let t of r)e.has(t)||this.getTopologicalDependents(t,e,i);return i.insert(t),i}getNodes(){return this.relationships.keys()}toString(){let t="";for(let e of this.getNodes())for(let i of this.getDependents(e,!0))t+=e.toString()+"->"+i.toString()+"\n";return t}static Generate(t){let e=new r,i=0,s=t.indexOf("->",i);for(;s>0;){let r=t.substring(i,s);i=s+1,s=t.indexOf("\n",s);let n=t.substring(i+1,s);e.addDependency(r,n),i=s+1,s=t.indexOf("->",i)}return e}}class n{elements;dependencyGraph;constructor(){this.dependencyGraph=new r,this.elements=new Map}clear(){this.dependencyGraph=new r,this.elements.clear()}add(t){this.dependencyGraph.add(t),this.elements.set(t.id,t)}remove(t){this.dependencyGraph.remove(t),this.elements.delete(t.id)}get(t){return this.elements.get(t)}update(t){let e=this.dependencyGraph.getDependents(t);for(let t of e)t.update()}}class o{static disable=!1;static controller=new n;static count=0;_id;update;constructor(){this._id=`${this.constructor.name.toLowerCase()}-${o.count++}`,o.controller.add(this)}static clear(t=!1){o.count=0,o.controller.clear(),o.disable=t}get id(){return this._id}remove(){o.controller.remove(this)}addDependency(...t){for(let e of t)o.controller.dependencyGraph.addDependency(e,this)}updateDependents(){o.controller.update(this)}}class h extends o{root;style;classList;constructor(t){super(),this.root=t,this.root.id=this.id,this.root.classList.add(this.constructor.name.toLowerCase()),this.style=this.root.style,this.classList=this.root.classList}setAttribute(t,e){return this.root.setAttribute(t,e),this}getAttribute(t){return this.root.getAttribute(t)}appendChild(t){return this.root.appendChild(t.root),t}prependChild(t){return this.root.prepend(t.root),t}contains(t){return this.root.contains(t.root)}remove(){o.controller.remove(this),this.root.remove()}clear(){let t;for(;t=this.root.firstChild;)o.controller.get(t.id).remove()}getBoundingBox(){return this.root instanceof SVGGraphicsElement?this.root.getBBox():null}}class l extends h{constructor(t){let e=document.createElementNS("http://www.w3.org/2000/svg","a");e.setAttributeNS(null,"href",t),super(e)}setAttribute(t,e){return this.root.setAttribute(t,e),this}getAttribute(t){return this.root.getAttribute(t)}}class a extends h{constructor(t){super(t)}setAttribute(t,e){return this.root.setAttribute(t,e),this}getAttribute(t){return this.root.getAttribute(t)}getPointAtLength(t){return this.root.getPointAtLength(t)}getTotalLength(){return this.root.getTotalLength()}isPointInFill(t){return this.root.isPointInFill(t)}isPointInStroke(t){return this.root.isPointInStroke(t)}}class d extends a{constructor(t,e,i){let s=document.createElementNS("http://www.w3.org/2000/svg","circle");s.setAttributeNS(null,"cx",t.toString()),s.setAttributeNS(null,"cy",e.toString()),s.setAttributeNS(null,"r",i.toString()),super(s)}get r(){return this.root.r.baseVal.value}set r(t){this.root.r.baseVal.value=t}get cx(){return this.root.cx.baseVal.value}set cx(t){this.root.cx.baseVal.value=t}get cy(){return this.root.cy.baseVal.value}set cy(t){this.root.cy.baseVal.value=t}getPath(){throw new Error("Method not implemented.")}translate(t,e){this.root.cx.baseVal.value=this.root.cx.baseVal.value+t,this.root.cy.baseVal.value=this.root.cy.baseVal.value+e}get fill(){return this.root.style.fill}set fill(t){this.root.style.fill=t}get stroke(){return this.root.style.stroke}set stroke(t){this.root.style.stroke=t}}class u extends a{constructor(t,e,i,s){let r=document.createElementNS("http://www.w3.org/2000/svg","ellipse");r.setAttributeNS(null,"cx",t.toString()),r.setAttributeNS(null,"cy",e.toString()),r.setAttributeNS(null,"rx",i.toString()),r.setAttributeNS(null,"ry",s.toString()),super(r)}get cx(){return this.root.cx.baseVal.value}set cx(t){this.root.cx.baseVal.value=t}get cy(){return this.root.cy.baseVal.value}set cy(t){this.root.cy.baseVal.value=t}get rx(){return this.root.rx.baseVal.value}set rx(t){this.root.rx.baseVal.value=t}get ry(){return this.root.ry.baseVal.value}set ry(t){this.root.ry.baseVal.value=t}translate(t,e){this.root.cx.baseVal.value=this.root.cx.baseVal.value+t,this.root.cy.baseVal.value=this.root.cy.baseVal.value+e}get fill(){return this.root.style.fill}set fill(t){this.root.style.fill=t}get stroke(){return this.root.style.stroke}set stroke(t){this.root.style.stroke=t}}class c extends a{constructor(t,e,i,s){let r=document.createElementNS("http://www.w3.org/2000/svg","line");r.setAttributeNS(null,"x1",t.toString()),r.setAttributeNS(null,"y1",e.toString()),r.setAttributeNS(null,"x2",i.toString()),r.setAttributeNS(null,"y2",s.toString()),super(r)}get x1(){return this.root.x1.baseVal.value}set x1(t){this.root.x1.baseVal.value=t}get y1(){return this.root.y1.baseVal.value}set y1(t){this.root.y1.baseVal.value=t}get x2(){return this.root.x2.baseVal.value}set x2(t){this.root.x2.baseVal.value=t}get y2(){return this.root.y2.baseVal.value}set y2(t){this.root.y2.baseVal.value=t}translate(t,e){this.root.x1.baseVal.value+=t,this.root.y1.baseVal.value+=e,this.root.x2.baseVal.value+=t,this.root.y2.baseVal.value+=e}get fill(){return this.root.style.fill}set fill(t){this.root.style.fill=t}get stroke(){return this.root.style.stroke}set stroke(t){this.root.style.stroke=t}}class p extends a{constructor(t,e,i,s){let r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttributeNS(null,"x",t.toString()),r.setAttributeNS(null,"y",e.toString()),r.setAttributeNS(null,"width",i.toString()),r.setAttributeNS(null,"height",s.toString()),super(r)}setAttribute(t,e){return this.root.setAttribute(t,e),this}getAttribute(t){return this.root.getAttribute(t)}get x(){return this.root.x.baseVal.value}set x(t){this.root.x.baseVal.value=t}get y(){return this.root.y.baseVal.value}set y(t){this.root.y.baseVal.value=t}get width(){return this.root.width.baseVal.value}set width(t){this.root.width.baseVal.value=t}get height(){return this.root.height.baseVal.value}set height(t){this.root.height.baseVal.value=t}translate(t,e){this.root.x.baseVal.value=this.root.x.baseVal.value+t,this.root.y.baseVal.value=this.root.y.baseVal.value+e}get fill(){return this.root.style.fill}set fill(t){this.root.style.fill=t}get stroke(){return this.root.style.stroke}set stroke(t){this.root.style.stroke=t}}class g extends a{constructor(t){let e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",t),super(e)}get d(){return this.root.getAttribute("d")}set d(t){this.root.setAttribute("d",t)}static getPath(t){throw Error("Not Implemented")}}class x extends a{constructor(t){let e=document.createElementNS("http://www.w3.org/2000/svg","polygon");e.setAttributeNS(null,"points",t),super(e)}get points(){return this.root.getAttribute("points")}}class w extends h{constructor(){super(document.createElementNS("http://www.w3.org/2000/svg","desc"))}}class y extends h{constructor(){super(document.createElementNS("http://www.w3.org/2000/svg","metadata"))}}class b extends h{constructor(){super(document.createElementNS("http://www.w3.org/2000/svg","title"))}}class f extends h{constructor(){super(document.createElementNS("http://www.w3.org/2000/svg","clipPath"))}circle(t,e,i){return this.appendChild(new d(t,e,i))}ellipse(t,e,i,s){return this.appendChild(new u(t,e,i,s))}line(t,e,i,s){return this.appendChild(new c(t,e,i,s))}path(t){return this.appendChild(new g(t))}polygon(t){return this.appendChild(new x(t))}rectangle(t,e,i,s){return this.appendChild(new p(t,e,i,s))}description(){return this.appendChild(new w)}metadata(){return this.appendChild(new y)}title(){return this.appendChild(new b)}}class m extends h{constructor(){super(document.createElementNS("http://www.w3.org/2000/svg","defs"))}}class v extends h{constructor(){super(document.createElementNS("http://www.w3.org/2000/svg","symbol"))}get x(){throw new Error("Not Implemented")}set x(t){throw new Error("Not Implemented")}get y(){throw new Error("Not Implemented")}set y(t){throw new Error("Not Implemented")}get width(){throw new Error("Not Implemented")}set width(t){throw new Error("Not Implemented")}get height(){throw new Error("Not Implemented")}set height(t){throw new Error("Not Implemented")}get preserveAspectRatio(){throw new Error("Not Implemented")}set preserveAspectRatio(t){throw new Error("Not Implemented")}get viewBox(){return this.root.getAttribute("viewBox")}set viewBox(t){this.root.setAttributeNS(null,"viewBox",t)}get refX(){throw new Error("Not Implemented")}set refX(t){throw new Error("Not Implemented")}get refY(){throw new Error("Not Implemented")}set refY(t){throw new Error("Not Implemented")}}class _ extends h{constructor(t){let e=document.createElementNS("http://www.w3.org/2000/svg","tspan");e.innerHTML=t,super(e)}get text(){return this.root.innerHTML}set text(t){this.root.innerHTML=t}setAttribute(t,e){return this.root.setAttribute(t,e),this}getAttribute(t){return this.root.getAttribute(t)}tspan(t){let e=new _(t);return this.root.appendChild(e.root),e}}class A extends h{constructor(t,e,i=""){let s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttributeNS(null,"x",t.toString()),s.setAttributeNS(null,"y",e.toString()),null!=i&&(s.innerHTML=i),super(s)}setAttribute(t,e){return this.root.setAttribute(t,e),this}getAttribute(t){return this.root.getAttribute(t)}set contents(t){this.root.innerHTML=t}get contents(){return this.root.innerHTML}get x(){return Number(this.root.getAttribute("x"))}get y(){return Number(this.root.getAttribute("y"))}set x(t){this.root.setAttribute("x",t.toString())}set y(t){this.root.setAttribute("y",t.toString())}get length(){return document.createElement("canvas").getContext("2d").measureText(this.root.innerHTML).width}text(t,e,i){let s=new A(t,e,i);return this.root.appendChild(s.root),s}tspan(t){let e=new _(t);return this.root.appendChild(e.root),e}}class C extends h{constructor(t,e,i,s){let r=document.createElementNS("http://www.w3.org/2000/svg","use");r.setAttributeNS(null,"x",t.toString()),r.setAttributeNS(null,"y",e.toString()),r.setAttributeNS(null,"width",i.toString()),r.setAttributeNS(null,"height",s.toString()),super(r)}get href(){return this.root.href.baseVal}set href(t){this.root.href.baseVal=t}get x(){return this.root.x.baseVal.value}set x(t){this.root.x.baseVal.value=t}get y(){return this.root.y.baseVal.value}set y(t){this.root.y.baseVal.value=t}get width(){return this.root.width.baseVal.value}set width(t){this.root.width.baseVal.value=t}get height(){return this.root.height.baseVal.value}set height(t){this.root.height.baseVal.value=t}}class S extends h{constructor(t,e,i,s){let r=document.createElementNS("http://www.w3.org/2000/svg","marker");r.setAttributeNS(null,"refX",t.toString()),r.setAttributeNS(null,"refY",e.toString()),r.setAttributeNS(null,"markerWidth",i.toString()),r.setAttributeNS(null,"markerHeight",s.toString()),super(r)}setAttribute(t,e){return this.root.setAttribute(t,e),this}getAttribute(t){return this.root.getAttribute(t)}get viewBox(){return this.getAttribute("viewBox")}set viewBox(t){this.setAttribute("viewBox",t)}get refX(){return this.root.refX.baseVal.value}set refX(t){this.root.refX.baseVal.value=t}get refY(){return this.root.refY.baseVal.value}set refY(t){this.root.refY.baseVal.value=t}get width(){return this.root.markerWidth.baseVal.value}set width(t){this.root.markerWidth.baseVal.value=t}get height(){return this.root.markerHeight.baseVal.value}set height(t){this.root.markerHeight.baseVal.value=t}description(){return this.appendChild(new m)}metadata(){return this.appendChild(new y)}title(){return this.appendChild(new b)}defs(){return this.appendChild(new m)}group(){return this.appendChild(new E)}svg(){return this.appendChild(new N)}symbol(){return this.appendChild(new v)}use(t,e,i,s){return this.appendChild(new C(t,e,i,s))}circle(t,e,i){return this.appendChild(new d(t,e,i))}ellipse(t,e,i,s){return this.appendChild(new u(t,e,i,s))}line(t,e,i,s){return this.appendChild(new c(t,e,i,s))}path(t){return this.appendChild(new g(t))}polygon(t){return this.appendChild(new x(t))}rectangle(t,e,i,s){return this.appendChild(new p(t,e,i,s))}text(t,e,i){return this.appendChild(new A(t,e,i))}}class M extends h{constructor(){super(document.createElementNS("http://www.w3.org/2000/svg","script"))}setAttribute(t,e){return this.root.setAttribute(t,e),this}getAttribute(t){return this.root.getAttribute(t)}}class N extends h{constructor(t,e,i,s){let r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("xmlns","http://www.w3.org/2000/svg"),t&&r.setAttributeNS(null,"x",t.toString()),e&&r.setAttributeNS(null,"y",e.toString()),i&&r.setAttributeNS(null,"width",i.toString()),s&&r.setAttributeNS(null,"height",s.toString()),super(r)}static SVG(t,e,i,s,r){let n;if("string"==typeof t){if(n=document.getElementById(t),null==n)throw new Error(`There is no HTML element with the id: ${t}`)}else n=t;let o=new N(e,i,s,r);return n.appendChild(o.root),o}get width(){return parseInt(this.root.getAttribute("width"))}set width(t){this.root.setAttributeNS(null,"width",t.toString())}get height(){return parseInt(this.root.getAttribute("height"))}set height(t){this.root.setAttributeNS(null,"height",t.toString())}get x(){return this.root.x.baseVal.value}set x(t){this.root.x.baseVal.value=t}get y(){return this.root.y.baseVal.value}set y(t){this.root.y.baseVal.value=t}get viewBox(){return this.root.getAttribute("viewBox")}set viewBox(t){this.root.setAttribute("viewBox",t)}setViewBox(t,e,i,s){this.viewBox=`${t} ${e} ${i} ${s}`}setAttribute(t,e){return this.root.setAttribute(t,e),this}getAttribute(t){return this.root.getAttribute(t)}description(){return this.appendChild(new w)}metadata(){return this.appendChild(new y)}title(){return this.appendChild(new b)}circle(t,e,i){return this.appendChild(new d(t,e,i))}ellipse(t,e,i,s){return this.appendChild(new u(t,e,i,s))}line(t,e,i,s){return this.appendChild(new c(t,e,i,s))}path(t){return this.appendChild(new g(t))}polygon(t){return this.appendChild(new x(t))}rectangle(t,e,i,s){return this.appendChild(new p(t,e,i,s))}defs(){return this.appendChild(new m)}group(){return this.appendChild(new E)}svg(t,e,i,s){return this.appendChild(new N(t,e,i,s))}symbol(){return this.appendChild(new v)}use(t,e,i,s){return this.appendChild(new C(t,e,i,s))}text(t,e,i){return this.appendChild(new A(t,e,i))}a(t){return this.appendChild(new l(t))}clipPath(){return this.appendChild(new f)}marker(t,e,i,s){return this.appendChild(new S(t,e,i,s))}script(){return this.appendChild(new M)}}class E extends h{constructor(){super(document.createElementNS("http://www.w3.org/2000/svg","g"))}setAttribute(t,e){return this.root.setAttribute(t,e),this}getAttribute(t){return this.root.getAttribute(t)}description(){return this.appendChild(new w)}metadata(){return this.appendChild(new y)}title(){return this.appendChild(new b)}defs(){return this.appendChild(new m)}group(){return this.appendChild(new E)}svg(t,e,i,s){return this.appendChild(new N(t,e,i,s))}symbol(){return this.appendChild(new v)}use(t,e,i,s){return this.appendChild(new C(t,e,i,s))}circle(t,e,i){return this.appendChild(new d(t,e,i))}ellipse(t,e,i,s){return this.appendChild(new u(t,e,i,s))}line(t,e,i,s){return this.appendChild(new c(t,e,i,s))}path(t){return this.appendChild(new g(t))}polygon(t){return this.appendChild(new x(t))}rectangle(t,e,i,s){return this.appendChild(new p(t,e,i,s))}text(t,e,i){return this.appendChild(new A(t,e,i))}a(t){return this.appendChild(new l(t))}clipPath(){return this.appendChild(new f)}}class V extends E{_onchange;constructor(){super();let t=this;t._onchange=function(){t.updateDependents()}}set onchange(t){this._onchange=t}get onchange(){return this._onchange}}class B extends C{constructor(t,e,i,s){super(t,e,i,s),this.classList.add("icon")}}class L extends V{_count=0;_active;_x;_y;box;label;constructor(t,e,i){super(),this._x=t,this._y=e,this._active=!1,this.root.setAttribute("transform",`translate(${t},${e})`),this.root.classList.add("button"),this.label=new A(0,1,i),this.label.root.setAttribute("alignment-baseline","middle"),this.label.root.style.textAnchor="middle",this.box=this.rectangle(0,-16,2*this.label.length+16,32),this.box.root.setAttribute("rx","2px"),this.label.x=this.box.x+this.box.width/2,this.appendChild(this.label);let s=this;this.root.onmousedown=()=>{s.active=!this.active},this.root.onmouseup=()=>{s.active=!this.active}}get x(){return this._x}set x(t){this._x=t,this.root.setAttribute("transform",`translate(${this._x},${this._y})`)}get y(){return this._y}set y(t){this._y=t,this.root.setAttribute("transform",`translate(${this._x},${this._y})`)}get count(){return this._count}get active(){return this._active}set active(t){this.active&&!t&&this._count++,this._active=t,this._active?(this.box.style.fill="#f8f8f8",this.box.style.stroke="#333333",this.box.style.strokeWidth="1px",this.label.style.fill="#404040"):(this.box.style.fill="",this.label.style.fill=""),this.onchange()}set onclick(t){this.root.onclick=t,this.onchange()}}class X extends V{_value=!1;box;label;constructor(t,e,i,s){super(),this.root.setAttribute("transform",`translate(${t},${e})`),this.box=new p(-6.5,-6.5,13,13),this.box.root.setAttribute("rx","2px"),this.label=new A(18,1,i),this.label.root.setAttribute("alignment-baseline","middle"),this.root.appendChild(this.box.root),this.root.appendChild(this.label.root);let r=this;this.value=s,this.box.root.onmousedown=function(){r.toggle()},this.addDependency(this.box)}set value(t){(this._value=t)?this.box.style.fill="#404040":this.box.style.fill="",this.onchange()}get value(){return this._value}number(){return this.value?1:0}toggle(){this.value=!this.value}}class Y extends V{static pointRadius=4;static handleRadius=13;static active=null;static slopX=0;static slopY=0;static prevX=0;static prevY=0;_x;_y;_dx;_dy;static initalized=!1;point;handle;constrain=function(t,e){return e};constructor(t,e){super(),this.point=this.circle(0,0,Y.pointRadius),this.handle=this.circle(0,0,Y.handleRadius),this.point.classList.add("point"),this.handle.classList.add("handle"),this.root.classList.add("control"),this._x=t,this._y=e,this._dx=0,this._dy=0,this.update=()=>{},this.translate(t,e),this.root.onmousedown=this.handleMouseDown.bind(this),this.handle.root.onmouseout=this.handleMouseOut.bind(this),this.handle.root.addEventListener("touchstart",this.handleTouchStart.bind(this),{passive:!1}),Y.initalized||(window.onmouseover=Y.handleMouseOver,window.onmousemove=Y.handleMouseMove,window.onmouseup=Y.handleInputEnd,window.addEventListener("touchend",Y.handleInputEnd,{passive:!1}),window.addEventListener("touchmove",Y.handleTouchMove,{passive:!1}),Y.initalized=!0)}static handleMouseMove(t){null!=Y.active&&(Y.handleMoveTo(t.clientX,t.clientY),t.preventDefault())}static handleTouchMove(t){null!=Y.active&&(Y.handleMoveTo(t.touches[0].clientX,t.touches[0].clientY),t.preventDefault())}static handleMoveTo(t,e){let i=t+Y.slopX,s=e+Y.slopY;Y.active.translate(i,s)}static handleInputEnd(t){null!=Y.active&&(Y.active.handle.root.classList.remove("highlight"),Y.active=null,"touchend"!=t.type&&t.target.dispatchEvent(new MouseEvent("mouseover",{view:window,bubbles:!0,cancelable:!0})))}static handleMouseOver(t){null!=Y.active||o.disable||"circle"!=t.target.tagName||t.target.classList.add("highlight")}handleMouseOut(t){null==Y.active&&t.target.classList.remove("highlight")}handleMouseDown(t){o.disable||(t.preventDefault(),t.stopPropagation(),Y.active=this,Y.slopX=Y.active.x-t.clientX,Y.slopY=Y.active.y-t.clientY,Y.prevX=t.clientX,Y.prevY=t.clientY)}handleTouchStart(t){o.disable||(Y.active=this,Y.slopX=Y.active.x-t.touches[0].clientX,Y.slopY=Y.active.y-t.touches[0].clientY,t.preventDefault())}translate(t,e){let i=this.constrain({x:this.x,y:this.y},{x:t,y:e});this._dx=i.x-this._x,this._dy=i.y-this._y,this._x=i.x,this._y=i.y,this.root.setAttribute("transform",`translate( ${this.x}, ${this.y})`),this.onchange()}set x(t){this._dx=t-this.x,this._x=t,this.root.setAttribute("transform","translate( "+this.x+", "+this.y+")")}set y(t){this._dy=t-this.y,this._y=t,this.root.setAttribute("transform","translate( "+this.x+", "+this.y+")")}get x(){return this._x}get y(){return this._y}get dx(){return this._dx}get dy(){return this._dy}constrainTo(t){if(this.addDependency(t),t instanceof g)throw Error("not implemented");t instanceof d?this.constrain=function(e,i){let s=Math.atan2(i.y-t.cy,i.x-t.cx);return{x:t.r*Math.cos(s)+t.cx,y:t.r*Math.sin(s)+t.cy}}:t instanceof p&&(this.constrain=function(e,i){let s=i.x,r=i.y,n=t.x,o=t.y,h=t.x+t.width,l=t.y+t.height,a=t.x+t.width/2,d=t.y+t.height/2;return r>=l&&s>=h?(r=l,s=h):r<=o&&s<=n?(r=o,s=o):r<=o&&s>=h?(r=o,s=h):r>=l&&s<=n?(r=l,s=n):s>n&&s<h?r=r>d?l:o:s=s>a?h:n,{x:s,y:r}})}constrainWithin(t){if(this.addDependency(t),t instanceof g)throw Error("not implemented");t instanceof d?this.constrain=function(e,i){if(Math.hypot(i.y-t.cy,i.x-t.cx)>t.r){let e=Math.atan2(i.y-t.cy,i.x-t.cx);return{x:t.r*Math.cos(e)+t.cx,y:t.r*Math.sin(e)+t.cy}}return i}:t instanceof p&&(this.constrain=function(e,i){let s=i.x,r=i.y,n=t.x,o=t.y,h=t.x+t.width,l=t.y+t.height;return s<n&&(s=n),r<o&&(r=o),s>h&&(s=h),r>l&&(r=l),{x:s,y:r}})}constrainToCircle(t,e,i){this.constrain=function(s,r){let n=Math.atan2(r.y-e,r.x-t);return{x:i*Math.cos(n)+t,y:i*Math.sin(n)+e}}}constrainWithinBox(t,e,i,s){this.constrain=function(r,n){let o=n.x,h=n.y;return o<t&&(o=t),h<e&&(h=e),o>i&&(o=i),h>s&&(h=s),{x:o,y:h}}}constrainWithinRange(t,e){this.constrain=function(i,s){let r=s.x,n=s.y;return r<t&&(r=t),r>e&&(r=e),{x:r,y:n}}}constrainToX(t=-1/0,e=1/0){this.constrain=function(t,e){return{x:e.x,y:t.y}}}constrainToY(){this.constrain=function(t,e){return{x:t.x,y:e.y}}}}class k extends Y{static circleRadius=10;constructor(t,e){super(t,e),this.point.r=k.circleRadius,this.handle.r=k.circleRadius+.8,this.handle.style.strokeWidth="2",this.point.style.fill=this.handle.style.stroke}}class $ extends V{list;index;constructor(t,e,i,s=0){if(void 0===i||0==i.length)throw new Error("Labels must not be empty");super(),this.root.setAttribute("transform",`translate(${t},${e})`),this.index=s;let r=0;this.list=[];let n=this;i.forEach(((t,e)=>{let i=new X(0,r,t,!1);e==s&&(i.value=!0),i.box.root.setAttribute("rx","8px"),i.box.root.onmousedown=function(){n.handleMouseDown(e),i.value=!0,n.index=e,n.onchange()},this.root.appendChild(i.root),this.list.push(i),r+=24}))}get value(){return this.list[this.index].label.contents}getCurrentValue(){return this.list[this.index].label}handleMouseDown(t){this.list.forEach((t=>{t.value=!1}))}}class T extends V{optionLabels;currentIndex;textWidth;expanded;currSelection;currSelectionBox;currSelectionText;collapsedView;expandedView;x;y;constructor(t,e,i,s){if(void 0===i||0===i.length)throw new Error("Dropdown control must have at least one option");if(s<0||s>=i.length)throw new Error("Default index must be within bounds of option labels array.");super(),this.optionLabels=i,this.currentIndex=s,this.expanded=!1,this.textWidth=new A(0,0,this.getLongestString(i)).length,this.x=t,this.y=e,this.collapsedView=new E,this.collapsedView.setAttribute("transform",`translate(${this.x},${this.y})`),this.currSelection=new E,this.currSelection.root.classList.add("dropdown-control-curr-selection-box"),this.currSelectionText=new A(0,1,this.optionLabels[this.currentIndex]),this.currSelectionText.root.setAttribute("alignment-baseline","middle"),this.currSelectionText.style.textAnchor="middle",this.currSelectionBox=new p(0,-16,3*this.textWidth+16,32),this.currSelectionText.x=this.currSelectionBox.x+this.currSelectionBox.width/2,this.currSelection.appendChild(this.currSelectionBox),this.currSelection.appendChild(this.currSelectionText);let r=new E;r.root.classList.add("dropdown-control-button");let n=new p(3*this.textWidth+16,-16,32,32),o=new g(` M ${8+3*this.textWidth+32} ${8*Math.sin(-2*Math.PI/3)+1}\n                                 L ${8*Math.cos(-2*Math.PI/3)+3*this.textWidth+28} ${8*Math.sin(-2*Math.PI/3)+1}\n                                 L ${(8+3*this.textWidth+32+8*Math.cos(-2*Math.PI/3)+3*this.textWidth+28)/2} ${8*Math.sin(-4*Math.PI/3)+1}\n                                 Z`);o.style.fill="#333333",r.appendChild(n),r.appendChild(o);let h=this;r.root.onmousedown=function(){h.expanded?(h.root.removeChild(h.expandedView.root),h.expanded=!1):(h.updateExpandedView(),h.root.appendChild(h.expandedView.root),h.expanded=!0),h.onchange()},this.collapsedView.appendChild(this.currSelection),this.collapsedView.appendChild(r),this.root=this.collapsedView.root,this.root.id=this.id}get value(){return this.optionLabels[this.currentIndex]}updateExpandedView(){this.expandedView=new E,this.collapsedView.setAttribute("transform",`translate(${this.x},${this.y})`);let t=new E;t.root.classList.add("dropdown-control-menu-option");let e=new A(0,1,this.optionLabels[this.currentIndex]);e.root.setAttribute("alignment-baseline","middle"),e.style.textAnchor="middle";let i=new p(0,-16,3*this.textWidth+16,32);e.x=i.x+i.width/2,t.appendChild(i),t.appendChild(e),this.expandedView.appendChild(t);let s=this,r=32;this.optionLabels.forEach(((t,e)=>{if(e==this.currentIndex)return;let i=new E;i.root.classList.add("dropdown-control-menu-option");let n=new A(0,1+r,t);n.root.setAttribute("alignment-baseline","middle"),n.style.textAnchor="middle";let o=new p(0,-16+r,3*this.textWidth+16,32);n.x=o.x+o.width/2,i.appendChild(o),i.appendChild(n),i.root.onmousedown=function(){s.root.removeChild(s.expandedView.root),s.expanded=!1,s.currentIndex=e,s.currSelectionText.contents=t,s.onchange()},this.expandedView.appendChild(i),r+=32}))}getCurrentSelection(){return this.optionLabels[this.currentIndex]}getLongestString(t){if(0==t.length)return"";let e=t[0];for(let i=1;i<t.length;i++)t[i].length>e.length&&(e=t[i]);return e}}class P extends V{x;y;_min;_max;_line;_control;constructor(t,e,i){let s,r;super(),this.x=t,this.y=e,s=i.width?i.width:100,r=i.value?i.value:0,i.min?this._min=i.min:this._min=0,i.max?this._max=i.max:this._max=1,this._line=this.line(t,e,t+s,e),this._line.root.style.strokeWidth="1.5",this._line.root.style.strokeLinecap="round",this._control=new k(t+r,e),this._control.constrainWithinBox(t,e,t+s,e),this._control.point.r-=1.5,this._control.handle.r-=2,this._control.handle.style.strokeWidth="2",this.appendChild(this._control),this.value=r;let n=this,o=n._control.onchange;n._control.onchange=function(){o(),n.onchange()}}get width(){return this._line.x2-this._line.x1}set width(t){this._line.x2=this._line.x1+t,this._control.constrainWithinBox(this._line.x1,this._line.y1,this._line.x2,this._line.y2)}get value(){return(this._control.x-this._line.x1)/this.width*this.range+this._min}set value(t){this._control.x=this._line.x1+(t-this._min)/this.range*this.width}set step(t){let e=this._line;this._control.constrain=function(t,i){let s=i.x,r=i.y;return s<e.x1&&(s=e.x1),r<e.y1&&(r=e.y1),s>e.x2&&(s=e.x2),r>e.y2&&(r=e.y2),s=50*Math.floor(s/50),{x:s,y:r}}}get min(){return this._min}set min(t){this._min=t}get max(){return this._max}set max(t){this._max=t}get range(){return this.max-this.min}}class I extends P{active;loop;done;playButton;pauseButton;requestID;constructor(t,e,i){let s={width:486,...i};s.width=s.width-80,super(t+80,e,s),this.active=!1,this.loop=!1,this.done=!1;let r=this.circle(0,0,16);r.style.fill="#eeeeee",r.style.stroke="#333333",r.style.strokeWidth="1px";let n=this.path(` M 8 0\n                                  L ${8*Math.cos(-2*Math.PI/3)} ${8*Math.sin(-2*Math.PI/3)}\n                                  L ${8*Math.cos(-4*Math.PI/3)} ${8*Math.sin(-4*Math.PI/3)}\n                                  Z`);n.style.fill="#333333",this.playButton=this.group(),this.playButton.appendChild(r),this.playButton.appendChild(n),this.playButton.setAttribute("transform",`translate( ${t}, ${e})`);let o=this.circle(0,0,16);o.style.fill="#eeeeee",o.style.stroke="#333333",o.style.strokeWidth="1px";let h=this.path(" M -3.5 -5\n                                L -3.5 5\n                                M 3.5 -5\n                                L 3.5 5");h.style.stroke="#333333",h.style.strokeWidth="2",h.style.strokeLinecap="round",this.pauseButton=this.group(),this.pauseButton.appendChild(o),this.pauseButton.appendChild(h),this.pauseButton.setAttribute("transform",`translate( ${t+42}, ${e})`);let l=this;this.playButton.root.addEventListener("click",(function(){l.play()})),this.pauseButton.root.addEventListener("click",(function(){l.pause()}));let a=this.onchange;this.onchange=function(){l.value==l.max?l.done=!0:l.done=!1,a()}}play(){if(!this.active){let t=this;t.active=!0,this.done&&(this.value=this.min,this.done=!1);let e=.0025*t.range,i=function(s){t.value=t.value+e,t.value>t.max&&!t.loop?(t.value=t.max,t.pause(),t.done=!0,t.onchange()):(t.value=t.value%t.max,t.onchange(),t.requestID=window.requestAnimationFrame(i))};window.requestAnimationFrame(i)}}pause(){this.active=!1,window.cancelAnimationFrame(this.requestID)}}class D extends V{box;label;_x;_xBound=null;_y;_yBound=null;constructor(t){super(),this.label=new A(0,1,t),this.label.root.setAttribute("alignment-baseline","middle"),this.label.root.style.textAnchor="middle",this.box=this.rectangle(0,-16,2*this.label.length+16,32),this.box.root.setAttribute("rx","2px"),this.box.fill="white",this.box.stroke="black",this.box.style.fillOpacity="0.9",this.label.x=this.box.x+this.box.width/2,this.appendChild(this.label),this._x=this.box.x,this._y=this.box.y,this.root.setAttribute("visibility","hidden")}set x(t){this._xBound&&t>=this._xBound-this.box.width&&(t=this._xBound-this.box.width),this._x=t,this.box.x=this._x,this.label.x=this.box.x+this.box.width/2}set y(t){this._yBound&&(t>=this._yBound-this.box.height?t=this._yBound-this.box.height:t<=this.box.height&&(t=this.box.height)),this._y=t,this.box.y=this._y-37,this.label.y=this.box.y+this.box.height/2}setBounds(t,e){this._xBound=t,this._yBound=e}setText(t){this.label.contents=t,this.label.x=this.box.x+this.box.width/2,this.label.y=this.box.y+this.box.height/2,this.box.width=2*this.label.length+16}updatePosition(t,e){this.x=t,this.y=e}showHoverBox(){this.root.removeAttribute("visibility")}hideHoverBox(){this.root.setAttribute("visibility","hidden")}}class W extends E{nodeName;nodeEllipse;edges;children;parents;depth;_cx;_text;_cy;_rx;_ry;constructor(t,e,i,s,r){super(),this.depth=0,this._cx=t,this._cy=e,this._text=r,this._rx=i,this._ry=s,this.edges=new Set,this.nodeName=new A(t,e,r),this.nodeName.style.textAnchor="middle",this.nodeName.root.setAttribute("alignment-baseline","middle"),this.nodeEllipse=new u(t,e,i,s),this.nodeEllipse.fill="#f8f8f8",this.children=[],this.parents=[],this.root.appendChild(this.nodeEllipse.root),this.root.appendChild(this.nodeName.root)}edgeWeight(){return this.edges.size}translate(t,e){this.nodeEllipse.cx+=t,this.nodeName.x+=t,this._cx+=t,this.nodeEllipse.cy+=e,this.nodeName.y+=e,this._cy+=e}get cx(){return this._cx}get cy(){return this._cy}set cx(t){this._cx=t,this.nodeEllipse.cx=t,this.nodeName.x=t,this.edges.forEach((function(t){t.redraw()}))}set cy(t){this._cy=t,this.nodeEllipse.cy=t,this.nodeName.y=t,this.edges.forEach((function(t){t.redraw()}))}get rx(){return this._rx}get ry(){return this._ry}get label(){return this._text}set label(t){this.nodeName.contents=t,this._text=t}set rx(t){this._rx=t,this.nodeEllipse.rx=t}set ry(t){this._ry=t,this.nodeEllipse.ry=t}addEdge(t){t.nodeFrom==this?this.children.push(t.nodeTo):(this.depth=t.nodeFrom.depth+1,this.parents.push(t.nodeFrom)),this.edges.add(t)}}class G extends c{directed;nodeFrom;nodeTo;constructor(t,e,i){let s=G.calculateLinePosition(t,e);G.calculateLinePositionEllipse(t,e),i&&!Number.isNaN(s[0])?super(s[0],s[1],s[2],s[3]):super(t.cx,t.cy,e.cx,e.cy),this.directed=i,this.nodeFrom=t,this.nodeTo=e}redraw(){this.x1=this.nodeFrom.cx,this.y1=this.nodeFrom.cy,this.x2=this.nodeTo.cx,this.y2=this.nodeTo.cy}static calculateLinePosition(t,e){let i=t.nodeEllipse.cy,s=e.nodeEllipse.cy,r=t.nodeEllipse.cx,n=e.nodeEllipse.cx,o=s-i,h=n-r,l=Math.sqrt(h*h+o*o),a=t.nodeEllipse.rx/l*h,d=t.nodeEllipse.rx/l*o,u=e.nodeEllipse.rx/l*h,c=e.nodeEllipse.rx/l*o;return new Array(r+a,i+d,n-u,s-c)}static calculateLinePositionEllipse(t,e){let i=t.cx-e.cx,s=t.cy-e.cy,r=Math.atan(s/i),n=Math.cos(r),o=Math.sin(r),h=e.cx*e.cy/Math.sqrt(Math.pow(e.cx,2)*Math.pow(n,2)+Math.pow(e.cy,2)*Math.pow(o,2));return t.cx,t.cy,Math.sqrt(t.cx*Math.pow(n,2)+t.cy*Math.pow(o,2)),new Array(h*n,h*o)}}class F extends E{nodes;options;constructor(t){super(),this.nodes=[],this.options=t;let e=this.defs();e.root.innerHTML='<marker id="arrow" refX="10" refY="5" markerWidth="10" markerHeight="10" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" style="fill:#333333;"></path></marker>',this.appendChild(e)}clear(){for(var t=0;t<this.nodes.length;t++)this.nodes[t].edges.forEach((function(t){t.remove()})),this.nodes[t].remove();this.nodes=[]}addNode(t,e,i,s=20,r=20){let n=new W(t,e,s,r,i);return this.root.appendChild(n.root),this.nodes.push(n),n}addEdge(t,e){let i=new G(t,e,this.options.directed);return this.options.directed&&i.root.setAttribute("marker-end","url(#arrow)"),this.root.prepend(i.root),t.addEdge(i),e.addEdge(i),i}getNodes(){return this.nodes}size(){return this.nodes.length}tidy(t){let e=[];this.postTraverse(t,e);let i={},s={};for(let t of e)if(s[t.id]=0,t.cx=0,0!=t.children.length){t.children[0].cx;for(let e=1;e<t.children.length;e++)t.children[e].cx=t.children[e-1].cx+100;s[t.id]=(t.children[0].cx+t.children[t.children.length-1].cx)/2}for(let t of e)t.cy=75*t.depth+50,null!=t.parents[0]&&t.parents[0].children[0]!==t?(t.cx=t.parents[0].children[t.parents[0].children.indexOf(t)-1].cx+100,i[t.id]=t.cx-s[t.id]):(t.cx=s[t.id],i[t.id]=0);this.shiftChildrenByMod(t,0,i),i=this.clearModMap(i),i=this.fixConflicts(t,e,i),this.fixOffScreen(t,i),t.cx=(t.children[0].cx+t.children[t.children.length-1].cx)/2}fixOffScreen(t,e){let i={};i=this.leftContour(t,i);let s=0;for(let t in i)i[t]<s&&(s=i[t]);t.cx+=s+50,e[t.id]+=s+50,this.shiftChildrenByMod(t,0,e)}fixConflicts(t,e,i){let s=!1;for(let r of e)if(null!=r.parents[0]&&r.parents[0].children[0]!==r){let e=-1;for(let t=0;t<r.parents[0].children.length;t++)if(r.parents[0].children[t]===r){e=t;break}for(let n=e-1;n>=0&&r.parents[0].children[n]!==r;n--){let e={};e=this.leftContour(r,e);let o={};o=this.rightContour(r.parents[0].children[n],o);let h=this.calculateShift(e,o);0!=h&&(s=!0),r.cx+=h,i[r.id]+=h,this.shiftChildrenByMod(t,0,i),i=this.clearModMap(i);let l=0;for(let t=n;t<r.parents[0].children.length;t++)if(r.parents[0].children[t]===r){l=t;break}for(let t=n+1;t<l;t++)r.parents[0].children[t].cx+=h/(l-n),i[r.parents[0].children[t].id]+=h/(l-n)}}return i}shiftChildrenByMod(t,e,i){t.cx+=e;for(let s of t.children)this.shiftChildrenByMod(s,e+i[t.id],i)}clearModMap(t){for(let e in t)t[e]=0;return t}calculateShift(t,e){let i=0;for(let s in t)void 0!==e[s]&&t[s]-100<e[s]&&(i=Math.abs(t[s]-100-e[s]));return i}leftContour(t,e){(void 0===e[t.depth]||e[t.depth]>t.cx)&&(e[t.depth]=t.cx);for(let i of t.children)e=this.leftContour(i,e);return e}rightContour(t,e){(void 0===e[t.depth]||e[t.depth]<t.cx)&&(e[t.depth]=t.cx);for(let i of t.children)e=this.rightContour(i,e);return e}postTraverse(t,e){return t||console.log("ERROR: Node was null"),t.children.length>0&&t.children.forEach((t=>{this.postTraverse(t,e)})),e.push(t),e}}class O extends N{featureName;externalJSON;featuresMap;mapOptions;constructor(t,e,i={}){super(),this.mapOptions={fill:"white",stroke:"black",strokeWidth:.5,nonScalingStroke:!0,...i},this.featureName=t,this.externalJSON=e,this.featuresMap=new Map,this.draw(t)}draw(t){this.clearPaths(),this.featureName=""!=t?t:null,this.loadExternalJSON(t),this.featuresMap.forEach((t=>{this.appendChild(t)}));let e=this.root.getBBox();this.setViewBox(e.x,e.y,e.width,e.height)}removeFeature(t){this.featuresMap.has(t)&&(this.featuresMap.get(t).remove(),this.featuresMap.delete(t))}clearPaths(){let t=this.root.getElementsByClassName("feature");for(;t.length>0;)t[0].remove();this.featuresMap=new Map}getPathForFeatureName(t){return this.featuresMap.get(t)}getAllFeaturePaths(){return Array.from(this.featuresMap.values())}getHTMLFeatureElements(){return Array.from(this.root.children)}setViewBoxToFeature(t){if(this.featuresMap.has(t)){let e=this.featuresMap.get(t).root.getBBox();this.setViewBox(e.x,e.y,e.width,e.height)}}resetViewBox(){let t=this.root.getBBox();this.setViewBox(t.x,t.y,t.width,t.height)}setupGroup(t){let e=new E;return e.classList.remove("element"),e.root.setAttribute("name",t),e.style.stroke=this.mapOptions.stroke,e.style.fill=this.mapOptions.fill,e.style.strokeWidth=this.mapOptions.strokeWidth.toString(),e.classList.add("feature"),e}loadExternalJSON(t){var e=this.externalJSON,i=null;null!=this.featureName&&(i=t.toLowerCase().split(","));var s=1;try{for(let t=0;t<e.features.length;t++)for(let r=0;r<e.features[t].geometry.coordinates.length;r++){let n=e.features[t].properties.name;if(null!=this.featureName){if(null!=i&&!i.includes(n.toLowerCase()))continue;if(!this.featuresMap.has(n)){let t=this.setupGroup(n);this.featuresMap.set(n,t)}}else if(!this.featuresMap.has(n)){let t=this.setupGroup(n);this.featuresMap.set(n,t)}if(1==e.features[t].geometry.coordinates[r].length){let i=this.featuresMap.get(n).path("M 0 0");this.mapOptions.nonScalingStroke&&i.root.setAttribute("vector-effect","non-scaling-stroke");let o=e.features[t].geometry.coordinates[r][0][0][0],h=e.features[t].geometry.coordinates[r][0][0][1];for(i.d=`M ${o} ${-1*h}  `,s=1;s<e.features[t].geometry.coordinates[r][0].length;s++){let n=e.features[t].geometry.coordinates[r][0][s][0],o=e.features[t].geometry.coordinates[r][0][s][1];i.d+=`L ${n} ${-1*o} `}}else{let i=this.featuresMap.get(n).path("M 0 0");this.mapOptions.nonScalingStroke&&i.root.setAttribute("vector-effect","non-scaling-stroke");let o=e.features[t].geometry.coordinates[r][0][0],h=e.features[t].geometry.coordinates[r][0][1];for(i.d=`M ${o} ${-1*h} `,s=1;s<e.features[t].geometry.coordinates[r].length;s++){let n=e.features[t].geometry.coordinates[r][s][0],o=e.features[t].geometry.coordinates[r][s][1];i.d+=`L ${n} ${-1*o} `}}}}catch(t){throw new Error("There was an error processing the provided GeoJSON: "+t)}}onchange(){this.updateDependents()}}function H(t){const e=1e6,i=1e5,s=1e-4,r=1e-5,n=1e-6;return t>=e?e:t>=i?i:t>=1e4?1e4:t>=1e3?1e3:t>=100?100:t>=10?10:t>=1?1:t>=.1?.1:t>=.01?.01:t>=.001?.001:t>=s?s:t>=r?r:t>=n?n:void 0}class R extends N{rect;clipGroup;viewPort;staticGroup;fPath;displayCircle;xAxis;yAxis;grid;xRect;yRect;xText;yText;active;_function;_x;_y;_width;_height;scaleX;scaleY;internalX;internalY;visibleWidth;visibleHeight;prevX;prevY;constructor(t,e){let i={x:0,y:0,width:700,height:400,margin:50,scaleX:1,scaleY:1,grid:!0,labels:!0,border:!0,zoomable:!1,displayPoint:!1,controls:!1,...e};super(i.x,i.y,i.width,i.height),this.prevX=0,this.prevY=0,this.active=!1,this._function=t,this._width=i.width-2*i.margin,this._height=i.height-2*i.margin,this._x=-this._width/2,this._y=-this._height/2,this.rect=this.rectangle(i.margin,i.margin,this._width,this._height),this.rect.style.fill="transparent",i.border?this.rect.style.border="1px solid #404040":this.rect.style.stroke="none";let s=this.clipPath();s.rectangle(0,0,this._width,this._height),this.clipGroup=this.group(),this.clipGroup.setAttribute("clip-path",`url(#${s.id})`),this.clipGroup.setAttribute("transform",`translate(${i.margin}, ${i.margin})`),this.viewPort=this.clipGroup.svg(0,0,this._width,this._height),this.viewPort.setAttribute("preserveAspectRatio","none"),this.staticGroup=this.clipGroup.group(),this.xAxis=this.staticGroup.line(-1e4,0,1e4,0),this.yAxis=this.staticGroup.line(0,-1e4,0,1e4),this.staticGroup.circle(0,0,3).fill="#404040",this.scaleX=i.scaleX,this.scaleY=i.scaleY,this.visibleWidth=this._width/this.scaleX,this.visibleHeight=this._height/this.scaleY,this.internalX=-this.visibleWidth/2,this.internalY=-this.visibleHeight/2,this.fPath=this.staticGroup.path(""),this.fPath.setAttribute("transform","scale(1, -1)"),this.setViewBox(),null!=i.originX&&null!=i.originY&&this.setOrigin(i.originX,i.originY),i.grid&&(this.grid=this.viewPort.group(),this.grid.classList.add("grid"),this.grid.style.opacity=".4",this.drawGrid());let r=this;if((void 0===i.displayPoint||i.displayPoint)&&(this.displayCircle=this.staticGroup.circle(0,0,4),this.displayCircle.style.fill="cornflowerblue",this.displayCircle.setAttribute("transform","scale(1, -1)"),this.xRect=this.rectangle(0,0,125,40),this.yRect=this.rectangle(120,0,125,40),this.xRect.root.style.fill="white",this.yRect.root.style.fill="white",this.xText=this.text(15,20,"x:0"),this.xText.root.style.dominantBaseline="middle",this.xText.root.style.whiteSpace="pre",this.yText=this.text(140,20,"y:0"),this.yText.root.style.dominantBaseline="middle",this.yText.root.style.whiteSpace="pre",this.root.addEventListener("mousemove",(function(t){r.handleMouseMove(t)}))),(void 0===i.zoomable||i.zoomable)&&(this.root.addEventListener("mousedown",(function(t){r.handleMouseDown(t)})),this.root.addEventListener("mouseup",(function(t){r.handleMouseUp(t)})),this.root.addEventListener("mouseleave",(function(t){r.handleMouseLeave(t)})),this.root.addEventListener("mousewheel",(function(t){r.handleMouseWheelEvent(t)}),{passive:!1})),i.controls){let t=this.rectangle(this._width-48,16,30,30);t.setAttribute("rx","3"),t.style.fill="#f8f8f8";let e=this.rectangle(this._width-48,46,30,30);e.setAttribute("rx","3"),e.style.fill="#f8f8f8",this.circle(this._width-32,this._height-32,16).style.fill="#f8f8f8"}if(this.draw(),i.labels){let t,e=this.group();e.style.fontFamily="KaTeX_Main",e.style.fontSize="22px",i.title instanceof A?(t=e.appendChild(i.title),t.x=this.width/2,t.y=25):t=e.text(this.width/2,25,i.title),t.setAttribute("alignment-baseline","middle"),t.setAttribute("text-anchor","middle");let s=this.getXLabelPoints(),r=this.getYLabelPoints();for(let t of s){let s=this.internalToAbsolute(t),r=e.text(s.x+i.margin,i.margin+this._height+i.margin/2,`${t.x.toFixed(1)}`);r.setAttribute("alignment-baseline","middle"),r.setAttribute("text-anchor","middle")}for(let t of r){let s=this.internalToAbsolute(t),r=e.text(s.x+i.margin/2,s.y+i.margin,`${t.y.toFixed(1)}`);r.setAttribute("alignment-baseline","middle"),r.setAttribute("text-anchor","middle")}}}set function(t){this._function=t}get function(){return this._function}get originX(){return-this._x}get originY(){return-this._y}updateDisplayCircle(){if(null!=this.displayCircle){let t=this.call(this.displayCircle.cx,!1);isNaN(t)?this.displayCircle.cy=0:isFinite(t)?(this.displayCircle.cy=t,this.xText.contents=this.format(this.displayCircle.cx/this.scaleX),this.yText.contents=this.format(this.displayCircle.cy/this.scaleY)):(this.displayCircle.cy=3*this._height,this.xText.contents=this.format(this.displayCircle.cx/this.scaleX),this.yText.contents=t.toString())}}call(t,e=!1){let i=this.scaleY*this._function(t/this.scaleX);if(e){let t=8,e=this._y+this._height+t,s=this._y-t;-i>e&&(i=-e),-i<s&&(i=-s)}else{let t=this._y-this._height,e=this._y+2*this._height;-i>e&&(i=-e),-i<t&&(i=-t)}return i}format(t){return t>1e4||t<-1e4||t<.01&&t>-.01?t.toExponential(2):t.toPrecision(4)}draw(t=this._x-this._width,e=this._x+2*this._width,i=!1){this.setViewBox(),this.updateDisplayCircle();let s,r=!1,n=t,o=this.call(n,!1),h="";for(isNaN(o)||(h=`M ${n} ${o} `,s=o,r=!0),n+=1;n<e;n+=1){let t=this.call(n,i);!isNaN(t)&&isFinite(t)&&(Math.abs(s-t)>=this._height||!r?(h+=`M ${n.toFixed(1)} ${t.toFixed(1)} `,r=!0):h+=`L ${n.toFixed(1)} ${t.toFixed(1)} `,s=t)}this.fPath.d=h,this.updateDependents()}drawGrid(){this.grid.clear();let t=100*this.visibleWidth/this._width,e=100*this.visibleHeight/this._height,i=H(t),s=H(e),r=this.internalX,n=this.internalX+this.visibleWidth,o=this.internalY,h=this.internalY+this.visibleHeight,l=i*Math.floor(r/i);for(;l<n;)this.grid.line(l,o,l,h),l+=i;let a=s*Math.floor(h/s);for(;a>o;)this.grid.line(r,a,n,a),a-=s}internalToAbsolute(t){return{x:t.x*this.scaleX+this.originX,y:-(t.y*this.scaleY-this.originY)}}getXLabelPoints(){let t=[],e=H(250*this.visibleWidth/this._width),i=this.internalX,s=this.internalX+this.visibleWidth,r=this.internalY,n=e*Math.ceil(i/e);for(;n<=s;)t.push({x:n,y:r}),n+=e;return t}getYLabelPoints(){let t=[],e=H(250*this.visibleHeight/this._height),i=this.internalX,s=this.internalY,r=this.internalY+this.visibleHeight,n=e*Math.floor(r/e);for(;n>=s;)t.push({x:i,y:-n}),n-=e;return t}handleMouseDown(t){this.active=!0,this.prevX=t.clientX,this.prevY=t.clientY}handleMouseUp(t){this.active=!1}handleMouseLeave(t){this.handleMouseUp(t)}setViewBox(){this.staticGroup.setAttribute("transform",`translate(${-this._x}, ${-this._y})`),this.viewPort.setAttribute("viewBox",`${this.internalX} ${this.internalY} ${this.visibleWidth} ${this.visibleHeight}`)}setOrigin(t,e){this._x=-t,this._y=-e,this.internalX=this._x/this.scaleX,this.internalY=this._y/this.scaleY,this.draw()}handleMouseMove(t){if(this.active){let e=t.clientX-this.prevX,i=t.clientY-this.prevY;this._x-=e,this._y-=i,this.internalX-=e/this.scaleX,this.internalY-=i/this.scaleY,this.prevX=t.clientX,this.prevY=t.clientY,this.draw()}else{let e=this.rect.root.getBoundingClientRect();null!=this.displayCircle&&(this.displayCircle.cx=t.clientX-e.left+this._x,this.updateDisplayCircle())}}handleMouseWheelEvent(t){t.preventDefault();let e=this.rect.root.getBoundingClientRect(),i=t.clientX-e.left,s=t.clientY-e.top,r=t.deltaY<0?1:-1,n=Math.exp(.02*r),o=i/(this.scaleX*n)-i/this.scaleX,h=s/(this.scaleY*n)-s/this.scaleY;this.internalX-=o,this.internalY-=h,this.scaleX*=n,this.scaleY*=n,this.visibleWidth=this._width/this.scaleX,this.visibleHeight=this._height/this.scaleY,this._x=this.internalX*this.scaleX,this._y=this.internalY*this.scaleY,null!=this.displayCircle&&(this.displayCircle.cx=t.clientX-e.left+this._x),this.drawGrid(),this.draw()}export(){let t=new N(0,0,this._width,this._height);return this.xAxis.x1=this._x,this.xAxis.x2=this._x+this._width,this.yAxis.y1=this._y,this.yAxis.y2=this._y+this._height,this.draw(this._x-8,this._x+this._width+8,!0),t}}class z extends N{container;input;background;symbols;icons;_width;_height;_originX;_originY;constructor(t,e={}){if(super(),"string"==typeof t){if(this.container=document.getElementById(t),null===this.container||void 0===this.container)throw new Error(`There is no HTML element with the id: ${t}`)}else this.container=t;this.container.appendChild(this.root),this.root.classList.add("interactive"),this.background=new E,this.input=new E,this.root.appendChild(this.background.root),this.root.appendChild(this.input.root);let i={originX:0,originY:0,width:600,height:300,border:!1,...e};this._originX=i.originX,this._originY=i.originY,this._width=i.width,this._height=i.height,this.root.setAttribute("width",this._width.toString()),this.root.setAttribute("height",this._height.toString()),this.setViewBox(-this._originX,-this._originY,this._width,this._height),this.window=!1,this.border=i.border,this.container.addEventListener("mousedown",(function(t){t.preventDefault()}))}set width(t){this._width=t,this.root.setAttribute("width",t.toString()),this.setViewBox(-this._originX,-this._originY,this._width,this._height)}get width(){return this._width}set height(t){this._height=t,this.root.setAttribute("height",t.toString()),this.setViewBox(-this._originX,-this._originY,this._width,this._height)}get height(){return this._height}set originX(t){this._originX=t,this.setViewBox(-this._originX,-this._originY,this._width,this._height)}get originX(){return this._originX}set originY(t){this._originY=t,this.setViewBox(-this._originX,-this._originY,this._width,this._height)}get originY(){return this._originY}set window(t){t?this.root.classList.add("window"):this.root.classList.remove("window")}set border(t){t?this.root.classList.add("border"):this.root.classList.remove("border")}get minX(){return-this.originX}get minY(){return-this.originY}get maxX(){return this.minX+this._width}get maxY(){return this.minY+this._height}appendChild(t){return t instanceof V?this.input.appendChild(t):this.background.appendChild(t),t}interactive(t,e,i={}){let s=new z(this.id,i);return s.root.setAttribute("x",t.toString()),s.root.setAttribute("y",e.toString()),s}button(t,e,i){return this.appendChild(new L(t,e,i))}checkBox(t,e,i,s){return this.appendChild(new X(t,e,i,s))}icon(i,s,r,n,o,h={}){let l;l=void 0===h.baseURL?"resources/icons/":h.baseURL,void 0===this.symbols&&(this.symbols=new E,this.root.appendChild(this.symbols.root),this.icons=new Set);let a=new B(i,s,r,n);this.appendChild(a);let d=`${this.id}-${o}`;if(this.icons.has(d))a.href=`#${d}`;else{let i=this;t(`${l}${o}.svg`).then((function(t){let s=e(t),r=i.symbols.symbol();for(r.root.id=d,r.viewBox=s.getAttribute("viewBox");s.childNodes.length>0;)r.root.appendChild(s.childNodes[0]);a.href=`#${d}`})).catch((function(t){throw t}))}return this.icons.add(d),a}radioControl(t,e,i,s=0){return this.appendChild(new $(t,e,i,s))}dropdownControl(t,e,i,s){return this.appendChild(new T(t,e,i,s))}control(t,e){return this.appendChild(new Y(t,e))}controlCircle(t,e){return this.appendChild(new k(t,e))}plot(t,e){return this.appendChild(new R(t,e))}graph(t){return this.appendChild(new F(t))}hoverBox(t){return this.appendChild(new D(t))}map(t,e=null,i={}){let s=new O(e,t,i),r=this.appendChild(s),n=s.root.getBBox();return s.setViewBox(n.x,n.y,n.width,n.height),r}slider(t,e,i){return this.appendChild(new P(t,e,i))}scrubber(t,e,i){return this.appendChild(new I(t,e,i))}node(t,e,i,s,r){return this.appendChild(new W(t,e,i,s,r))}edge(t,e,i){return this.appendChild(new G(t,e,i))}async loadSVG(i){let s=new E;return this.appendChild(s),t(i).then((function(t){s.root.appendChild(e(t))})).catch((function(t){throw t})),s}}const q=z;window.Interactive=q})();